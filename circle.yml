machine:
  python:
    version: 2.7.6
  services:
    - docker
  hosts:
    cass1: 127.0.0.1

dependencies:
  cache_directories:
    - "/usr/local/lib"

  override:
    - mkdir -p /usr/local/lib
    - cp src/libs/libsodium.so.13.1.0 /usr/local/lib
    - ln -s /usr/local/lib/libsodium.so.13.1.0 /usr/local/lib/libsodium.so.13
    - ln -s /usr/local/lib/libsodium.so.13.1.0 /usr/local/lib/libsodium.so
    - pip install --upgrade pip
    - pip install fig
    - easy_install -U setuptools
    - pip install -r requirements.txt
    - python bootstrap.py
    - bin/buildout

test:
  override:
    - bin/py.test src/eavatar.hub/tests/unit/
    - fig up -d
    - bin/py.test src/eavatar.hub/tests/integration/
    - bin/hubcli create_space
    - bin/hubcli sync_tables
    - bin/py.test src/eavatar.hub/tests/functional/



